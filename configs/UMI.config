## This Octopus configuration file is intended for use in calling low frequency (<1%) somatic mutations
## in UMI high depth sequencing data. It was originally designed for Brad Chapman's bcbio low frequency validations
## (https://github.com/bcbio/bcbio_validations/tree/master/somatic-lowfreq).

### Author: Daniel Cooke (dcooke@well.ox.ac.uk)
### Date: 27/08/2018
### Octopus version: v0.5-beta

caller=cancer
#
## Set the caller to 'cancer' as we want somatic mutations.
#

#somatics-only=yes
#
## Uncomment this if you only want somatic mutations (rather than germline and somatic).
#

allow-octopus-duplicates=yes
#
## UMI sequencing purposefully contains duplicates, we don't want to remove these.
#

overlap-masking=off
#
## Due to the nature of UMI capture sequencing, we expect read templated to overlap.
#

downsample-above=4000
downsample-target=4000
#
## Increase the default downsampling limits.
#

min-kmer-prune=5
min-bubble-score=15
#
## Increase the assembler proposal thresholds to more appropriate values for high depth data.
## If the downsample limits are increased then be sure to consider also increasing these parameters.
#

max-haplotypes=400
#
## Increase the default maximum number of haplotypes to consider slightly which increases accuracy.
#

somatic-snv-mutation-rate=5e-4
somatic-indel-mutation-rate=1e-05
#
## Double the default somatic mutation rates
#

min-expected-somatic-frequency=0.004
min-credible-somatic-frequency=0.001
#
## Decrease somatic frequency thresholds to increase sensitivity to low frequency mutations.
#

max-somatic-haplotypes=5
#
## Increase the maximum number of somatic haplotypes to consider.
## The test data contains many cases of clustered somatics on unique haplotypes.
## I'm not sure the biological plausibility of this, but Octopus will miss these
## cases with the default of 2. Increasing the to 5 adds a considerable computational burden.
#

tumour-germline-concentration=5
#
## Increase the default tumour germline concentration.
## This parameter controls the shape of the Dirichlet mixture prior distribution.
## The default prior is relatively flat which works very well for paired calling
## since the normal is usually highly informative. A flatter prior means we are
## more robust to changes in germline copy number. Increasing this parameter
## adds more prior mass to lower frequency mutations, so we are more likely to
## classify these cases correctly without a normal. This can also improve computational
## runtime as the model generally reaches convergence faster.
#

somatic-filter-expression=QUAL < 2 | CC < 0.1 | GQ < 100 | MQ < 30 | SB > 0.4 | SD[.25] > 0.5 | BQ < 20 | DP < 100 | MF > 0.2 | EAC < 5
#
## Until we have sufficient training data for the random forest, here are some threshold filters which
## are better suited to UMI sequencing. The changes from the defaults are:
## * Add 'CC < 0.1': this will basically flag any variants with uncertain germline/somatic classification.
## * 'GQ < 100': We want to be very confident in the called genotypes.
## * 'SB > 0.4': Decrease default strand bias threshold as strand artefacts are more likely with capture sequencing.
## * Add 'SD[.25] > 0.5': This basically removes calls only seen on one strand, and complements SB (which tests for the *difference* in strand assignments between called alleles).
## * 'DP < 500': We are expecting very high depths, so a call with low depth indicates the call is on the border of the capture region which can be problematic.
## * Add EAC < 5: We want to see minimal support for the called variant.
## * Remove 'FRF': Since we are heavily downsampling we don't want this filter.
#